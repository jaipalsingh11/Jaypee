---
import "../styles/global.css";
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>Jaypee's Portfolio</title>
    <link rel="icon" type="image/png" href="/cursor2.png" />
  </head>

  <body>
    <!-- Custom cursor image -->
    <img id="custom-cursor" src="/cursor.png" alt="cursor" />

    <header>
      <div id="gradient"></div>

      <nav class="nav-bar">
        <ul class="nav-list">
          <div class="nav-left">
            <li><a href="/">Home</a></li>
            <li><a href="/Resumejp.pdf">Resume</a></li>
          </div>

          <li class="logo"><img src="/Logo.png" alt="Logo" /></li>

          <div class="nav-right">
            <li><a href="/posters">Interests</a></li>
            <li><a href="/mystory">My Story</a></li>
          </div>
        </ul>
      </nav>
    </header>

    <slot />

    <footer>
      <img id="image" width="100%" src="/footer-desktop.png" alt="" />
      <img id="mobile-image" src="/footer-mobile.png" alt="" />
    </footer>

    <script>
      if (window.innerWidth > 768) {
        const cursor = document.getElementById("custom-cursor");
        let rotation = 0;
        let lastScroll = window.scrollY;

        // Read current zoom from <html>. Falls back to 1 if not set/supported.
        const getZoom = () => {
          const z = parseFloat(getComputedStyle(document.documentElement).zoom);
          return Number.isFinite(z) && z > 0 ? z : 1;
        };
        let zoom = getZoom();
        window.addEventListener("resize", () => (zoom = getZoom()));

        // Follow mouse (adjusting for zoom)
        document.addEventListener("mousemove", (e) => {
          const target = e.target;

          if (target.tagName === "BUTTON" || target.tagName === "A") {
            cursor.style.display = "none";
            return;
          }
          cursor.style.display = "block";

          // position corrected for CSS zoom
          const x = e.clientX / zoom;
          const y = e.clientY / zoom;

          // Use transform for positioning + rotation in one place
          cursor.style.transform = `translate(${x}px, ${y}px) translate(-50%, -50%) rotate(${rotation}deg)`;
        });

        // Rotate PNG cursor on scroll
        window.addEventListener("scroll", () => {
          rotation += window.scrollY > lastScroll ? 10 : -10;
          lastScroll = window.scrollY;

          // keep the last translate (position) and just update rotation:
          // read current translate from the style and swap in new rotation
          const t = cursor.style.transform || "";
          cursor.style.transform =
            t.replace(/rotate\([^)]*\)/, "") + ` rotate(${rotation}deg)`;
        });
      }
    </script>
  </body>
</html>

<style>
  * {
    margin: 0;
  }

  * {
    cursor: none !important;
  }

  /* Show native hand on buttons and links */
  button,
  a {
    cursor: pointer !important;
  }

  body {
    cursor: none; /* hide default cursor */
    height: 100vh;
    overflow-x: clip;
  }

  #custom-cursor {
    position: fixed;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    pointer-events: none; /* don't block clicks */
    transform: translate(-50%, -50%);
    transition: transform 0.05s linear;
    z-index: 9999;
  }

  #gradient {
    height: 1000px;
    width: 100%;
    background: linear-gradient(to bottom, #7fc1e3, #ffffff);
    position: absolute;
    top: 0;
    left: 0;
    z-index: -1;
  }

  .nav-bar {
    padding: 50px 20px;
    display: flex;
    justify-content: center;
  }

  .nav-list {
    position: fixed;
    width: 100%;
    z-index: 1000;
    width: 85%;
    max-width: 1800px;
    background: white;
    border-radius: 70px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 30px;
    list-style: none;
    outline: solid rgb(125, 173, 205);
    outline-width: 1.8px;
    height: fit-content;
  }

  .nav-left,
  .nav-right {
    display: flex;
    font-family: "Recoleta", Georgia, serif;
    gap: 45px;
    padding: 0px 20px;
  }

  .logo img {
    height: 70px;
    padding: 0px;
  }

  .nav-list li a {
    color: #3498db;
    text-decoration: none;
    font-size: 36px;
    font-weight: 500;
  }

  footer {
    margin-top: 100px;
  }

  #mobile-image {
    display: none;
  }

  @media (max-width: 600px) {
    .nav-list li a {
      color: #3498db;
      text-decoration: none;
      font-size: 15px;
      font-weight: 500;
    }
    footer {
      margin-top: 0px;
    }
    .nav-list {
      padding: 5px 10px;
    }
    .nav-left,
    .nav-right {
      display: flex;
      font-family: "Recoleta", Georgia, serif;
      gap: 10px;
      padding: 0px 2px;
    }
    .logo img {
      height: 35px;
      padding: 0px;
      margin-bottom: -5px;
    }
    .nav-bar {
      padding: 10px 10px;
      display: flex;
      justify-content: center;
    }
    #custom-cursor {
      display: none;
    }

    body {
      cursor: auto;
    }
    #image {
      display: none;
    }
    #mobile-image {
      width: 100%;
      display: block;
      padding: 0;
    }
  }
  /* Desktop only */
  @media (min-width: 769px) {
    html {
      zoom: 0.7;
    } /* applies on desktop/tablet+ */
  }

  /* Mobile: reset zoom */
  @media (max-width: 768px) {
    html {
      zoom: 1;
    } /* no zoom on mobile */
  }
</style>
